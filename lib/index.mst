<!DOCTYPE HTML>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		li { margin-bottom: 1em; }
		.time { font-weight: bold }
	</style>
</head>
<body>
	{{ #trace }}
		From 
		<a href="https://www.google.com/maps/place/{{ src.lat }},{{ src.lon }}">{{ src.lat }} {{ src.lon }}</a>
		to
		<a href="https://www.google.com/maps/place/{{ dest.lat }},{{ dest.lon }}">{{ dest.lat }} {{ dest.lon }}</a>
	{{ /trace }}
	<ol>
		{{ #trips }}
			<li>
				{{ route.shortName }} from {{ srcStop.name }}
				<div class="time">
					in {{ srcStop.minutesUntil }} minutes
				</div>
				<div class="time">
					Arrive at <span class="timestamp">{{ destStop.arrivalTimestamp }}</span>
				</div>
				{{ #trace }}
					Trip ID: <a href="http://api.pugetsound.onebusaway.org/api/where/trip-details/{{ tripId }}.xml?key=TEST">{{ tripId }}</a>
				{{ /trace }}
			</li>
		{{ /trips }}
	</ol>
	<script>
		Array.prototype.forEach.call(document.querySelectorAll(".timestamp"),
			function(node) {
				// Convert to browser local time and format
				var d = new Date(parseInt(node.textContent, 10));
				var minutes = d.getMinutes() + "";

				if (minutes.length === 1) {
					minutes += "0";
				}

				node.textContent = d.getHours() + ":" + minutes;
			});
	</script>
</body>
</html>
